library(tidyverse)
houses <- read_csv("https://raw.githubusercontent.com/cobriant/EC320Lab9/main/Housing.csv")
houses %>%
ggplot(aes(x = area, y = price)) +
geom_point() +
geom_smooth(method = lm, se = FALSE)
houses %>%
lm(price ~ area, data = .) %>%
broom::tidy()
houses %>%
lm(log(price) ~ log(area), data = .) %>%
broom::tidy()
houses %>%
ggplot(aes(x = area, y = price)) +
geom_point() +
geom_smooth(method = lm, se = FALSE)
houses %>%
lm(log(price) ~ log(area), data = .) %>%
broom::tidy()
houses %>%
ggplot(aes(x = area, y = price)) +
geom_point() +
geom_smooth(method = lm, se = FALSE)
houses %>%
lm(log(price) ~ area, data = .) %>%
broom::tidy()
#' slope coefficient's estimate and statistical significance.
houses %>%
ggplot(aes(x = area, y = price)) +
geom_point() +
geom_smooth(method = lm, se = FALSE)
houses %>%
lm(log(price) ~ area + u, data = .) %>%
broom::tidy()
houses %>%
ggplot(aes(x = log(area), y = log(price))) +
geom_point() +
geom_smooth(method = lm, se = FALSE)
houses %>%
lm(log(price) ~ log(area), data = .) %>%
broom::tidy()
houses %>%
ggplot(aes(x = area, log(price))) +
geom_point() +
geom_smooth(method = lm, se = FALSE)
houses %>%
lm(log(price) ~ area, data = .) %>%
broom::tidy()
houses %>%
ggplot(aes(x = area, y = price)) +
geom_point() +
geom_smooth(method = lm, se = FALSE)
houses %>%
lm(price ~ area, data = .) %>%
broom::tidy()
houses %>%
ggplot(aes(x = area, y = price)) +
geom_point() +
geom_smooth(method = lm, se = FALSE)
houses %>%
lm(price ~ area, data = .) %>%
broom::tidy()
houses %>%
ggplot(aes(x = log(area), y = log(price))) +
geom_point() +
geom_smooth(method = lm, se = FALSE)
houses %>%
lm(log(price) ~ log(area), data = .) %>%
broom::tidy()
houses %>%
ggplot(aes(x = area, log(price))) +
geom_point() +
geom_smooth(method = lm, se = FALSE)
houses %>%
lm(log(price) ~ area, data = .) %>%
broom::tidy()
library(tidyverse)
houses <- read_csv("https://raw.githubusercontent.com/cobriant/EC320Lab9/main/Housing.csv")
houses %>%
ggplot(aes(x = bedrooms, log(price))) +
geom_jitter() +
geom_smooth(method = lm, se = FALSE)
houses %>%
lm(log(price) ~ bedrooms, data = .) %>%
broom::tidy()
houses %>%
ggplot(aes(x = bedrooms, log(price))) +
geom_point() +
geom_smooth(method = lm, se = FALSE)
houses %>%
lm(log(price) ~ bedrooms, data = .) %>%
broom::tidy()
houses %>%
ggplot(aes(x = bedrooms, log(price))) +
geom_jitter() +
geom_smooth(method = lm, se = FALSE)
houses %>%
lm(log(price) ~ bedrooms, data = .) %>%
broom::tidy()
#'
houses %>%
ggplot(aes(x = area, y = price)) +
geom_point() +
geom_smooth(method = lm, se = FALSE)
houses %>%
lm(price ~ area, data = .) %>%
broom::tidy()
houses %>%
lm(log(price) ~ ., data = .) %>%
broom::tidy()
houses %>%
mutate(
mainroad = if_else(mainroad == "yes", 1, 0),
guestroom = if_else(guestroom == "yes", 1, 0),
basement = if_else(basement == "yes", 1, 0),
hotwaterheating = if_else(hotwaterheating == "yes", 1, 0),
airconditioning = if_else(airconditioning == "yes", 1, 0),
prefarea = if_else(prefarea == "yes", 1, 0),
furnishingstatus = case_when(
furnishingstatus == "furnished" ~ 1,
furnishingstatus == "semi-furnished" ~ 0.5,
furnishingstatus == "unfurnished" ~ 0
)
) %>%
cor() %>%
view()
houses %>%
mutate(
bedrooms_resid = residuals(data = .),
log_price_resid = residuals(data = .)
) %>%
ggplot(aes(x = bedrooms_resid, y = log_price_resid)) +
geom_point() +
geom_smooth(method = lm)
houses %>%
mutate(
bedrooms_resid = residuals(lm(bedrooms ~ . - price, data = .)),
log_price_resid = residuals(lm(log(price) ~ bedrooms + . - price, data = .))
) %>%
ggplot(aes(x = bedrooms_resid, y = log_price_resid)) +
geom_point() +
geom_smooth(method = lm)
houses %>%
mutate(
bedrooms_resid = residuals(lm(bedrooms ~ . - price, data = .)),
log_price_resid = residuals(lm(log(price) ~ . - price, data = .))
) %>%
ggplot(aes(x = bedrooms_resid, y = log_price_resid)) +
geom_point() +
geom_smooth(method = lm)
houses %>%
mutate(
bedrooms_resid = residuals(lm(bedrooms ~ . - price, data = .)),
log_price_resid = residuals(lm(log(price) ~ bedrooms, data = .))
) %>%
ggplot(aes(x = bedrooms_resid, y = log_price_resid)) +
geom_point() +
geom_smooth(method = lm)
houses %>%
mutate(
bedrooms_resid = residuals(lm(bedrooms ~ . - price, data = .)),
log_price_resid = residuals(lm(bedrooms ~log(price) , data = .))
) %>%
ggplot(aes(x = bedrooms_resid, y = log_price_resid)) +
geom_point() +
geom_smooth(method = lm)
houses %>%
mutate(
bedrooms_resid = residuals(lm(bedrooms ~ . - price, data = .)),
log_price_resid = residuals(lm(log(price) ~ . - bedrooms, data = .))
) %>%
ggplot(aes(x = bedrooms_resid, y = log_price_resid)) +
geom_point() +
geom_smooth(method = lm)
#'
load(tidyverse,broom)
pacman::p_load(tidyverse, broom)
pacman::p_load(AER, tidyverse, broom)
#'
pacman::p_load(tidyverse, broom)
natal_df = readr::read_csv(
"https://raw.githubusercontent.com/ajdickinson/EC320S23/main/problem-sets/ps05/natality.csv"
)
natal_df %>%
view()
natal <- natal_df %>% select(-...1)
natal
natal %>%
view()
natal %>%
head(10)
natal %>%
count(row())
natal %>%
nrow() %>%
ncol()
natal %>%
nrow()
natal %>%
ncol()
natal %>%
nrow()
natal %>%
ncol()
natal %>%
geom_density(x = birth_wt)
natal %>%
ggplot(aes(x = birth_wt))+
geom_density()
natal %>%
ggplot(aes(x = birth_wt, y=cigs ))+
geom_density()
natal %>%
ggplot(aes(x = cigs, y = birth_wt ))+
geom_boxplot()
#' ## Categorical var
natal %>%
ggplot(aes(x = cigs, y = birth_wt ))+
geom_violin()
natal %>%
ggplot(aes(x= birth_wt, fill = cigs ))+
geom_density()
natal %>%
ggplot(aes(x= birth_wt, fill = cigs ))+
geom_density(alpha=.5)
ggplot(data = natal, aes(x= gestation, y = birth_wt))+
geom_point(size = 2, color = "cyan", shape = 4)+
labs(title = "gestation and birth waight", x = "gestation", y = "waight at birth")+
geom_smooth(color = "purple")
#'
#+ fig.height = 5, message = FALSE, warning = FALSE, fig.align = "center"
ggplot(data = natal, aes(x= gestation, y = birth_wt))+
geom_point(size = 2, color = "cyan")+
labs(title = "gestation and birth waight", x = "gestation", y = "waight at birth")+
geom_smooth(color = "purple")
#'
ggplot(data = natal, aes(x= gestation, y = birth_wt))+
geom_point(size = 2, color = "blue",alpha =.5)+
labs(title = "gestation and birth waight", x = "gestation", y = "waight at birth")+
geom_smooth(color = "purple")
ggplot(data = natal, aes(x= gestation, y = birth_wt))+
geom_point(size = 2, color = "blue",alpha =.05)+
labs(title = "gestation and birth waight", x = "gestation", y = "waight at birth")+
geom_smooth(color = "purple")
natal %>%
ggplot(aes(x= birth_wt, fill = cigs ))+
labs(title = "health and cigs", x = "Birth waight", fill = ("mothers us of Cigs"))+
geom_density(alpha=.5)
natal %>%
ggplot(aes(x= birth_wt, fill = cigs ))+
labs(title = "Health and Cigs", x = "Birth Waight", fill = ("Mothers Use Of Cigs"))+
geom_density(alpha=.5)
ggplot(data = natal, aes(x= gestation, y = birth_wt))+
geom_point(size = 2, color = "blue",alpha =.05)+
labs(title = "gestation and birth waight", x = "gestation", y = "waight at birth")+
geom_smooth(color = "purple")
ggplot(data = natal, aes(x= gestation, y = log(birth_wt)))+
geom_point(size = 2, color = "blue",alpha =.05)+
labs(title = "gestation and birth waight", x = "gestation", y = "waight at birth")+
geom_smooth(color = "purple")
ggplot(data = natal, aes(x= gestation, y = log(birth_wt)))+
geom_point(size = 2, color = "green",alpha =.05)+
labs(title = "gestation and birth waight", x = "gestation", y = "waight at birth")+
geom_smooth(color = "hotpink")
?geom_smooth
ggplot(data = natal, aes(x= gestation, y = log(birth_wt) + cigs))+
geom_point(size = 2, color = "darkgreen",alpha =.05)+
labs(title = "gestation and log birth waight", x = "gestation", y = "waight at birth logged")+
geom_smooth(color = "cyan")
ggplot(data = natal, aes(x= gestation, y = log(birth_wt)))+
geom_point(size = 2, color = "darkgreen",alpha =.05)+
labs(title = "gestation and log birth waight", x = "gestation", y = "waight at birth logged")+
geom_smooth(method = "lm", formula = y ~ x + cigs,color = "cyan")
#'
ggplot(data = natal, aes(x= gestation, y = log(birth_wt)))+
geom_point(size = 2, color = "darkgreen",alpha =.05)+
labs(title = "gestation and log birth waight", x = "gestation", y = "waight at birth logged")+
geom_smooth(method = "lm", formula = x ~ y + cigs,color = "cyan")
natal %>%
mutate(cigs= if_else(cigs == true, 1,0))
natal %>%
mutate(cigs= if_else(cigs == "true", 1,0))
ggplot( aes(x= gestation, y = log(birth_wt)))+
geom_point(size = 2, color = "darkgreen",alpha =.05)+
labs(title = "gestation and log birth waight", x = "gestation", y = "waight at birth logged")+
geom_smooth(method = "lm", formula = x ~ y + cigs,color = "cyan")
natal %>%
mutate(cigs= if_else(cigs == "true", 1,0)) %>%
ggplot( aes(x= gestation, y = log(birth_wt)))+
geom_point(size = 2, color = "darkgreen",alpha =.05)+
labs(title = "gestation and log birth waight", x = "gestation", y = "waight at birth logged")+
geom_smooth(method = "lm", formula = x ~ y + cigs,color = "cyan")
natal %>%
mutate(cigs= if_else(cigs = "true", 1,0)) %>%
ggplot( aes(x= gestation, y = log(birth_wt)))+
geom_point(size = 2, color = "darkgreen",alpha =.05)+
labs(title = "gestation and log birth waight", x = "gestation", y = "waight at birth logged")+
geom_smooth(method = "lm", formula = x ~ y + cigs,color = "cyan")
natal %>%
mutate(cigs = if_else(cigs =as.numeric(cigs))) %>%
ggplot( aes(x= gestation, y = log(birth_wt)))+
geom_point(size = 2, color = "darkgreen",alpha =.05)+
labs(title = "gestation and log birth waight", x = "gestation", y = "waight at birth logged")+
geom_smooth(method = "lm", formula = x ~ y + cigs,color = "cyan")
natal %>%
mutate(cigs = if_else(cigs_num =as.numeric(cigs))) %>%
ggplot( aes(x= gestation, y = log(birth_wt)))+
geom_point(size = 2, color = "darkgreen",alpha =.05)+
labs(title = "gestation and log birth waight", x = "gestation", y = "waight at birth logged")+
geom_smooth(method = "lm", formula = x ~ y + cigs_num,color = "cyan")
natal %>%
mutate(cigs_num =as.numeric(cigs)) %>%
ggplot( aes(x= gestation, y = log(birth_wt)))+
geom_point(size = 2, color = "darkgreen",alpha =.05)+
labs(title = "gestation and log birth waight", x = "gestation", y = "waight at birth logged")+
geom_smooth(method = "lm", formula = x ~ y + cigs_num,color = "cyan")
natal %>%
mutate(cigs = as.numeric(cigs)) %>%
ggplot( aes(x= gestation, y = log(birth_wt)))+
geom_point(size = 2, color = "darkgreen",alpha =.05)+
labs(title = "gestation and log birth waight", x = "gestation", y = "waight at birth logged")+
geom_smooth(method = "lm", formula = x ~ y + cigs,color = "cyan")
natal %>%
mutate(cigs = as.logical(cigs)) %>%
ggplot( aes(x= gestation, y = log(birth_wt)))+
geom_point(size = 2, color = "darkgreen",alpha =.05)+
labs(title = "gestation and log birth waight", x = "gestation", y = "waight at birth logged")+
geom_smooth(method = "lm", formula = x ~ y + cigs,color = "cyan")
natal %>%
mutate(cigs = as.logical(cigs)) %>%
ggplot( aes(x= gestation, y = log(birth_wt)))+
geom_point(size = 2, color = "darkgreen",alpha =.05)+
labs(title = "gestation and log birth waight", x = "gestation", y = "waight at birth logged")+
stat_smooth(method = "lm", formula = x ~ y + cigs,color = "cyan")
natal %>%
mutate(cigs = as.logical(cigs)) %>%
ggplot( aes(x= gestation, y = log(birth_wt)))+
geom_point(size = 2, color = "darkgreen",alpha =.05)+
labs(title = "gestation and log birth waight", x = "gestation", y = "waight at birth logged")+
geom_smooth(method = "lm", formula = y ~ x + cigs,color = "cyan")
#'
#'
natal %>%
mutate(cigs = as.integer(cigs)) %>%
ggplot( aes(x= gestation, y = log(birth_wt)))+
geom_point(size = 2, color = "darkgreen",alpha =.05)+
labs(title = "gestation and log birth waight", x = "gestation", y = "waight at birth logged")+
geom_smooth(method = "lm", formula = y ~ x + cigs,color = "cyan")
natal %>%
mutate(cigs = as.integer(cigs)) %>%
ggplot( aes(x= gestation, y = log(birth_wt)))+
geom_point(size = 2, color = "darkgreen",alpha =.05)+
labs(title = "gestation and log birth waight", x = "gestation", y = "waight at birth logged")+
geom_smooth(data=.,method = "lm", formula = y ~ x + cigs,color = "cyan")
natal %>%
mutate(cigs = as.integer(cigs)) %>%
ggplot( aes(x= gestation, y = log(birth_wt)))+
geom_point(size = 2, color = "darkgreen",alpha =.05)+
labs(title = "gestation and log birth waight", x = "gestation", y = "waight at birth logged")+
geom_smooth(data=natal,method = "lm", formula = y ~ x + cigs,color = "cyan")
natal %>%
mutate(cigs = if_else(cigs == "true", 1, 0)) %>%
ggplot( aes(x= gestation, y = log(birth_wt)))+
geom_point(size = 2, color = "darkgreen",alpha =.05)+
labs(title = "gestation and log birth waight", x = "gestation", y = "waight at birth logged")+
geom_smooth(data=natal,method = "lm", formula = y ~ x + cigs,color = "cyan")
#'
natal %>%
mutate(cigs = if_else(cigs == "TRUE", 1, 0)) %>%
ggplot( aes(x= gestation, y = log(birth_wt)))+
geom_point(size = 2, color = "darkgreen",alpha =.05)+
labs(title = "gestation and log birth waight", x = "gestation", y = "waight at birth logged")+
geom_smooth(data=natal,method = "lm", formula = y ~ x + cigs,color = "cyan")
